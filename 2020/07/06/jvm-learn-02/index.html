<!doctype html><html lang=en><head><title>JVM Learn 02 常量的那点东西 :: DongZhi.ME — A simple, retro blog for latest information technology!</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="常量在编译阶段会存入调用这个常量的方法所在类的常量池中，本质上调用类并没有直接引用定义常量的类，因此并不会出发定义常量类的初始化。如果该常量值时动态生成的，则不会放在常量池中，会导致定义常量的类主动使"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://dongzhi.me/2020/07/06/jvm-learn-02/><link rel=stylesheet href=https://dongzhi.me/assets/style.css><link rel=apple-touch-icon sizes=180x180 href=https://cdn.jsdelivr.net/gh/bugfix123/CDN@master/dongzhi.me/favicon_io//apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://cdn.jsdelivr.net/gh/bugfix123/CDN@master/dongzhi.me/favicon_io//favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://cdn.jsdelivr.net/gh/bugfix123/CDN@master/dongzhi.me/favicon_io//favicon-16x16.png><link rel=manifest href=https://cdn.jsdelivr.net/gh/bugfix123/CDN@master/dongzhi.me/favicon_io//site.webmanifest><meta name=twitter:card content="summary"><meta name=twitter:creator content="John Doe"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="JVM Learn 02 常量的那点东西 :: DongZhi.ME"><meta property="og:description" content="常量在编译阶段会存入调用这个常量的方法所在类的常量池中，本质上调用类并没有直接引用定义常量的类，因此并不会出发定义常量类的初始化。如果该常量值时动态生成的，则不会放在常量池中，会导致定义常量的类主动使用并初始化。"><meta property="og:url" content="https://dongzhi.me/2020/07/06/jvm-learn-02/"><meta property="og:site_name" content="JVM Learn 02 常量的那点东西"><meta property="og:image" content="https://dongzhi.me/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2020-07-06 00:00:00 +0000 UTC"><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/bugfix123/CDN@master/modules/plyr/3.6.2/plyr.css><link href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css rel=stylesheet></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>DongZhi.ME</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/>Home</a></li><li><a href=/archives>Archives</a></li><li><a href=/tags>Tags</a></li><li><a href=/search>Search</a></li><li><a href=/about>About</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/>Home</a></li><li><a href=/archives>Archives</a></li><li><a href=/tags>Tags</a></li><li><a href=/search>Search</a></li><li><a href=/about>About</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://dongzhi.me/2020/07/06/jvm-learn-02/>JVM Learn 02 常量的那点东西</a></h1><div class=post-meta><span class=post-date>2020-07-06</span>
<span class=post-author>::
John Doe</span></div><span class=post-tags>#<a href=https://dongzhi.me/tags/jvm/>jvm</a>&nbsp;</span><div class=post-content><div><blockquote><p>常量在编译阶段会存入调用这个常量的方法所在类的常量池中，本质上调用类并没有直接引用定义常量的类，因此并不会出发定义常量类的初始化。如果该常量值时动态生成的，则不会放在常量池中，会导致定义常量的类主动使用并初始化。
下面验证该结论。两个简单类的如下:</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#f92672>package</span> com.test.jvm.learn01<span style=color:#f92672>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Main</span> <span style=color:#f92672>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>		System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>Consts<span style=color:#f92672>.</span><span style=color:#a6e22e>s</span><span style=color:#f92672>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>	<span style=color:#f92672>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#f92672>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#f92672>package</span> com.test.jvm.learn01<span style=color:#f92672>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Consts</span> <span style=color:#f92672>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> String s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Hello world&#34;</span><span style=color:#f92672>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>	<span style=color:#66d9ef>static</span> <span style=color:#f92672>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>		System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;This is Consts&#34;</span><span style=color:#f92672>);</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>	<span style=color:#f92672>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#f92672>}</span>
</code></pre></div><p>然后执行main方法结果如下:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>......
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#f92672>[</span>Loaded java.io.FilePermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#f92672>[</span>Loaded java.io.FilePermission$1 from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#f92672>[</span>Loaded java.io.FilePermissionCollection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#f92672>[</span>Loaded java.security.AllPermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#f92672>[</span>Loaded java.security.UnresolvedPermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#f92672>[</span>Loaded java.security.BasicPermissionCollection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#f92672>[</span>Loaded com.test.jvm.learn01.Main from file:/E:/develop/workspace/workspace-eclipse-jee-neon/JVMLearning/bin/<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#f92672>[</span>Loaded sun.launcher.LauncherHelper$FXHelper from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#f92672>[</span>Loaded java.lang.Class$MethodArray from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#f92672>[</span>Loaded java.lang.Void from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>Hello world
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#f92672>[</span>Loaded java.lang.Shutdown from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#f92672>[</span>Loaded java.lang.Shutdown$Lock from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
</code></pre></div><p>如果把Consts类中final关键字去掉，打印结果如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>......
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#f92672>[</span>Loaded java.nio.MappedByteBuffer from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#f92672>[</span>Loaded java.nio.DirectByteBuffer from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#f92672>[</span>Loaded java.nio.LongBuffer from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#f92672>[</span>Loaded java.nio.DirectLongBufferU from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#f92672>[</span>Loaded java.security.PermissionCollection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#f92672>[</span>Loaded java.security.Permissions from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#f92672>[</span>Loaded java.net.URLConnection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#f92672>[</span>Loaded sun.net.www.URLConnection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#f92672>[</span>Loaded sun.net.www.protocol.file.FileURLConnection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#f92672>[</span>Loaded sun.net.www.MessageHeader from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#f92672>[</span>Loaded java.io.FilePermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#f92672>[</span>Loaded java.io.FilePermission$1 from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#f92672>[</span>Loaded java.io.FilePermissionCollection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#f92672>[</span>Loaded java.security.AllPermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#f92672>[</span>Loaded java.security.UnresolvedPermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#f92672>[</span>Loaded java.security.BasicPermissionCollection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#f92672>[</span>Loaded com.test.jvm.learn01.Main from file:/E:/develop/workspace/workspace-eclipse-jee-neon/JVMLearning/bin/<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#f92672>[</span>Loaded sun.launcher.LauncherHelper$FXHelper from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#f92672>[</span>Loaded java.lang.Class$MethodArray from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#f92672>[</span>Loaded java.lang.Void from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#f92672>[</span>Loaded com.test.jvm.learn01.Consts from file:/E:/develop/workspace/workspace-eclipse-jee-neon/JVMLearning/bin/<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>This is Consts
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>Hello world
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#f92672>[</span>Loaded java.lang.Shutdown from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#f92672>[</span>Loaded java.lang.Shutdown$Lock from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
</code></pre></div><p>可以看到第22中加载的类com.test.jvm.learn01.Consts。在第一种情况中，定义常量的类并没有被加载，常量s的值"hello world"存放在了类类Main的常量池中，类Main和Consts没有任何关系，甚至编译之后，可以把Consts.class文件删除掉，执行运行程序都能打印出正确结果。
特别地，需要注意的是，如果常量值是在程序运行时生成的，则定义常量的类依然会被引用，如：
String s = UUID.randomUUID().toString();</p><p>接着反编译Main.class文件，结果：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>$ javap -c Main.class
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>Compiled from <span style=color:#e6db74>&#34;Main.java&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>public class com.test.jvm.learn01.Main <span style=color:#f92672>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>  public com.test.jvm.learn01.Main<span style=color:#f92672>()</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>    Code:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>       0: aload_0
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>       1: invokespecial <span style=color:#75715e>#8                  // Method java/lang/Object.&#34;&lt;init&gt;&#34;:()V</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>       4: <span style=color:#66d9ef>return</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>  public static void main<span style=color:#f92672>(</span>java.lang.String<span style=color:#f92672>[])</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>    Code:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>       0: getstatic     <span style=color:#75715e>#16                 // Field java/lang/System.out:Ljava/io/PrintStream;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>       3: ldc           <span style=color:#75715e>#22                 // String Hello world</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>       5: invokevirtual <span style=color:#75715e>#24                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>       8: <span style=color:#66d9ef>return</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#f92672>}</span>
</code></pre></div><p>第三行的注释String Hello World表明已经Hello World常量异常存储到本类的常量池中。</p><p>如果在接口中放置常量会怎么样？接口中的变量默认修饰符是public static final，所以推断接口中定义了常量不会导致该接口被主动使用。同样地，如果该常量值是动态生成的，接口会被主动使用。代码和运行结果如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#f92672>package</span> com.test.jvm.learn01<span style=color:#f92672>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>MyInterface</span> <span style=color:#f92672>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>	<span style=color:#66d9ef>int</span> t <span style=color:#f92672>=</span> 20<span style=color:#f92672>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#f92672>}</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#f92672>[</span>Loaded sun.misc.Perf from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#f92672>[</span>Loaded sun.misc.PerfCounter$CoreCounters from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#f92672>[</span>Loaded sun.nio.ch.DirectBuffer from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#f92672>[</span>Loaded java.nio.MappedByteBuffer from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#f92672>[</span>Loaded java.nio.DirectByteBuffer from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#f92672>[</span>Loaded java.nio.LongBuffer from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#f92672>[</span>Loaded java.nio.DirectLongBufferU from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#f92672>[</span>Loaded java.security.PermissionCollection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#f92672>[</span>Loaded java.security.Permissions from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#f92672>[</span>Loaded java.net.URLConnection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#f92672>[</span>Loaded sun.net.www.URLConnection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#f92672>[</span>Loaded sun.net.www.protocol.file.FileURLConnection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#f92672>[</span>Loaded sun.net.www.MessageHeader from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#f92672>[</span>Loaded java.io.FilePermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#f92672>[</span>Loaded java.io.FilePermission$1 from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#f92672>[</span>Loaded java.io.FilePermissionCollection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#f92672>[</span>Loaded java.security.AllPermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#f92672>[</span>Loaded java.security.UnresolvedPermission from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#f92672>[</span>Loaded java.security.BasicPermissionCollection from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#f92672>[</span>Loaded com.test.jvm.learn01.Main from file:/E:/develop/workspace/workspace-eclipse-jee-neon/JVMLearning/bin/<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#f92672>[</span>Loaded sun.launcher.LauncherHelper$FXHelper from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#f92672>[</span>Loaded java.lang.Class$MethodArray from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#f92672>[</span>Loaded java.lang.Void from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#ae81ff>20</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#f92672>[</span>Loaded java.lang.Shutdown from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span style=color:#f92672>[</span>Loaded java.lang.Shutdown$Lock from C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\J</span>ava<span style=color:#ae81ff>\j</span>dk1.8.0_131<span style=color:#ae81ff>\j</span>re<span style=color:#ae81ff>\l</span>ib<span style=color:#ae81ff>\r</span>t.jar<span style=color:#f92672>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>
</code></pre></div><hr><p>这里有一些助记符：</p><ul><li>ldc:将int,float或者String类型的常量值从常量池中推送到栈顶，即将被使用。</li><li>bipush:将单字节的常量值推送到栈顶</li><li>sipush：将-32768~32767推送到栈顶</li><li>iconst_1：将常量值1推送到栈顶(iconst_1~iconst_5)</li></ul><hr><p>另外，VM选项设置：</p><ul><li><p><strong>-XX:<option></strong>开启option选项</p></li><li><p><strong>-XX:<option></strong>关闭option</p></li><li><p><strong>-XX:<option>=<value></strong>把option的值设置为value</p></li><li><p><strong>-XX:+TraceClassLoading</strong>表示开启类的追踪</p></li></ul></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://dongzhi.me/2020/07/06/jvm-learn-01/><span class=button__icon>←</span>
<span class=button__text>JVM Learn 01.类的加载之初体验</span></a></span>
<span class="button next"><a href=https://dongzhi.me/2020/07/06/jvm-learn-03/><span class=button__text>JVM Learn 03 理解类的初始化的一个简单例子</span>
<span class=button__icon>→</span></a></span></div></div><h3 style=margin-inline-start:1em;margin-bottom:auto>评论</h3><aside id=comments><div id=hyvor-talk-view></div><script type=text/javascript>var HYVOR_TALK_WEBSITE=1505;var HYVOR_TALK_CONFIG={url:false,id:false};</script><script async type=text/javascript src=https://talk.hyvor.com/web-api/embed></script></aside></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span style=margin-right:10px>:: Theme made by <a href=https://twitter.com/panr>panr</a></span>
<span id=busuanzi_container_site_uv>:: 您是本站第<span id=busuanzi_value_site_uv></span>位访客</span></div></div></footer><script src=https://dongzhi.me/assets/main.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=https://cdn.jsdelivr.net/gh/bugfix123/CDN@master/modules/plyr/3.6.2/plyr.polyfilled.min.js></script><script>const players=Plyr.setup('.js-player',{iconUrl:'/modules/plyr/3.6.2/plyr.svg'});</script></div></body></html>